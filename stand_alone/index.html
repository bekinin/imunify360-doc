<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to run Imunify360 in stand-alone mode on a Linux server | Documentation</title>
    <meta name="description" content="Imunify360 documentation">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.a68efb69.css" as="style"><link rel="preload" href="/assets/js/app.f76f4ac2.js" as="script"><link rel="preload" href="/assets/js/40.f1056a0e.js" as="script"><link rel="prefetch" href="/assets/js/10.5a9d04ff.js"><link rel="prefetch" href="/assets/js/11.a651b15e.js"><link rel="prefetch" href="/assets/js/12.45864d28.js"><link rel="prefetch" href="/assets/js/13.cbe74c51.js"><link rel="prefetch" href="/assets/js/14.72d50b15.js"><link rel="prefetch" href="/assets/js/15.258d4fe0.js"><link rel="prefetch" href="/assets/js/16.ac670ba5.js"><link rel="prefetch" href="/assets/js/17.0fe5fd5d.js"><link rel="prefetch" href="/assets/js/18.90b88dd0.js"><link rel="prefetch" href="/assets/js/19.a3c814fd.js"><link rel="prefetch" href="/assets/js/20.77df5484.js"><link rel="prefetch" href="/assets/js/21.f8c7c338.js"><link rel="prefetch" href="/assets/js/22.be8104a8.js"><link rel="prefetch" href="/assets/js/23.77b15885.js"><link rel="prefetch" href="/assets/js/24.a5434723.js"><link rel="prefetch" href="/assets/js/25.1c841075.js"><link rel="prefetch" href="/assets/js/26.b8a24c29.js"><link rel="prefetch" href="/assets/js/27.244996dd.js"><link rel="prefetch" href="/assets/js/28.ad16212a.js"><link rel="prefetch" href="/assets/js/29.798b45d3.js"><link rel="prefetch" href="/assets/js/3.2dc5277f.js"><link rel="prefetch" href="/assets/js/30.0eeb8c91.js"><link rel="prefetch" href="/assets/js/31.bb944555.js"><link rel="prefetch" href="/assets/js/32.8abef667.js"><link rel="prefetch" href="/assets/js/33.86d11818.js"><link rel="prefetch" href="/assets/js/34.46b71a75.js"><link rel="prefetch" href="/assets/js/35.84649d8e.js"><link rel="prefetch" href="/assets/js/36.1b3d730d.js"><link rel="prefetch" href="/assets/js/37.52273749.js"><link rel="prefetch" href="/assets/js/38.935a7c36.js"><link rel="prefetch" href="/assets/js/39.9e2233e0.js"><link rel="prefetch" href="/assets/js/4.fa0bbbcd.js"><link rel="prefetch" href="/assets/js/41.411d5abd.js"><link rel="prefetch" href="/assets/js/42.d6f2c067.js"><link rel="prefetch" href="/assets/js/43.65c1036d.js"><link rel="prefetch" href="/assets/js/44.d9b5461d.js"><link rel="prefetch" href="/assets/js/45.67ead859.js"><link rel="prefetch" href="/assets/js/5.30ee1738.js"><link rel="prefetch" href="/assets/js/6.8586fe30.js"><link rel="prefetch" href="/assets/js/7.53f73c57.js"><link rel="prefetch" href="/assets/js/8.55d21673.js"><link rel="prefetch" href="/assets/js/9.efaaf76a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.2f4e28c8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a68efb69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stand_alone/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/stand_alone/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stand_alone/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/stand_alone/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><a href="/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/terminology/" class="sidebar-link">Terminology</a></li><li><a href="/billing/" class="sidebar-link">Billing</a></li><li><a href="/installation/" class="sidebar-link">Installation Guide</a></li><li><a href="/stand_alone/" class="active sidebar-link">How to run Imunify360 in stand-alone mode on a Linux server</a></li><li><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></li><li><a href="/webshield/" class="sidebar-link">WebShield</a></li><li><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></li><li><a href="/firewall_config/" class="sidebar-link">Firewall Config</a></li><li><a href="/localization/" class="sidebar-link">Localization</a></li><li><a href="/dashboard/" class="sidebar-link">Imunify360 User Interface</a></li><li><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></li><li><a href="/config_file_description/" class="sidebar-link">Config File Description</a></li><li><a href="/features/" class="sidebar-link">Imunify360 Features</a></li><li><a href="/hooks/" class="sidebar-link">Hooks</a></li><li><a href="/command_line_interface/" class="sidebar-link">Command-line Interface (CLI)</a></li><li><a href="/uninstall/" class="sidebar-link">Uninstall</a></li><li><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></li><li><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/stand_alone/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    How to run Imunify360 in stand-alone mode on a Linux server
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/installation/" class="nav-arrow left"></a> <a href="/ids_integration/" class="nav-arrow right"></a></div></div> <div class="content"><h1 id="how-to-run-imunify360-in-stand-alone-mode-on-a-linux-server"><a href="#how-to-run-imunify360-in-stand-alone-mode-on-a-linux-server" aria-hidden="true" class="header-anchor">#</a> How to run Imunify360 in stand-alone mode on a Linux server</h1> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Prior to version 4.5, Imunify360 supported cPanel, Plesk, and
DirectAdmin control panels only. Starting from v4.5, Imunify360 could
be run on any CloudLinux OS, CentoOS 6/7, RHEL 6/7, and Ubuntu
16.04/18.04 systems without requiring any of these web panels to be
installed. Imunify360 can be run with any web panel, as the UI is
implemented using the single-page application (SPA) approach.</p></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The current version of Imunify360 requires Apache web-server.</p></div> <p>Below you can find the steps to install and run Imunify360 in
stand-alone mode (without panel) or within any hosting panel.</p> <h4 id="what-imunify360-requires-to-run-properly"><a href="#what-imunify360-requires-to-run-properly" aria-hidden="true" class="header-anchor">#</a> What Imunify360 requires to run properly</h4> <p>There are some basic steps to run Imunify360
as a stand-alone application.</p> <ol><li>Define a way to serve web-based UI</li> <li>Configure a user authentication process</li> <li>Implement integration scripts that provide Imunify360 with necessary information such as a list of users, domains hosted on
the server, panel administrators, general panel info</li> <li>Install prerequisites such as ModSecurity and remoteip web server modules</li> <li>Configure ModSecurity integration</li> <li>Configure malware scanner integration</li></ol> <div class="warning custom-block"><p class="custom-block-title">Warning</p> <p>Imunify Web-UI PHP code has to be executed under a user which has access to <span class="notranslate"><code>/var/run/defence360agent/non_root_simple_rpc.sock</code></span>. If it runs in CageFS, you'll need to configure it accordingly.</p></div> <h4 id="how-to-configure-imunify360-ui"><a href="#how-to-configure-imunify360-ui" aria-hidden="true" class="header-anchor">#</a> How to configure Imunify360 UI</h4> <div class="warning custom-block"><p class="custom-block-title">Note</p> <p>Imunify UI requires the <span class="notranslate"><code>proc_open</code></span> PHP function to be enabled. If you are unable to log in, you might see a related message in the <span class="notranslate"><code>errror.log</code></span> of the web-server.
If so, please remove it from the <span class="notranslate"><code>disable_functions</code></span> list in <code>php.ini</code>.</p></div> <p>Create the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span> file with the
<span class="notranslate"><code>ui_path</code></span> option defining a path that will serve web-based UI. For
example:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[paths]</span>
<span class="token constant">ui_path</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/www/vhosts/imunify360/imunify360.hosting.example.com/html/im360</span>
</code></pre></div></div> <p>Imunify360 will automatically copy UI files there during installation/upgrade.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Ensure that the domain you are going to use for the Imunify360
web-based UI refers to this path and that there are no other scripts
or files under <span class="notranslate"><code>ui_path</code></span>, as they might be overridden by the Imunify360
installation.</p></div> <h4 id="how-to-configure-authentication-for-imunify360-optional"><a href="#how-to-configure-authentication-for-imunify360-optional" aria-hidden="true" class="header-anchor">#</a> How to configure authentication for Imunify360 (optional)</h4> <p>Imunify360 can use PAM to authenticate users.
Once the UI is opened, the user sees a sign-in form. The credentials are checked via PAM.</p> <p>You can specify which PAM service Imunify360 should use with the <span class="notranslate"><code>service_name</code></span> option:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[pam]</span>
<span class="token constant">service_name</span> <span class="token attr-value"><span class="token punctuation">=</span> system-auth</span>
</code></pre></div></div> <p>If it is not specified, the <span class="notranslate"><code>system-auth</code></span> service is used.</p> <p>By default, <span class="notranslate"><code>root</code></span> is considered to be the only <span class="notranslate"><code>admin</code></span> user.  To
add more administrators, list them in the <span class="notranslate"><code>/etc/sysconfig/imunify360/auth.admin</code></span> file or specify the <span class="notranslate"><code>admins</code></span>
option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>ini
[integration_scripts]
admins = /path/to/get-admins-script.sh
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ru_ru&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h4 id="how-to-provide-imunify360-with-an-actual-list-of-users-optional"><a href="#how-to-provide-imunify360-with-an-actual-list-of-users-optional" aria-hidden="true" class="header-anchor">#</a> How to provide Imunify360 with an actual list of users (optional)</h4> <p>By default, Imunify360 will use Linux system users, limited
by <span class="notranslate"><code>uid_min</code></span> and <span class="notranslate"><code>uid_max</code></span> from <span class="notranslate"><code>/etc/login.defs</code></span></p> <p>If you want to see a specific list of users (note, that all of them
must be real Linux users accessible via PAM), you can specify the
<span class="notranslate"><code>users</code></span> option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">users</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-users-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following (domains are optional):</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3@ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1001</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4@ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Any type of an executable file is acceptable. For example,
you can use a Python or PHP script.</p></div> <p><strong>Data description</strong></p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td>Key</td> <td>Nullable</td> <td>Description</td></tr> <tr><td><span class="notranslate"><code>id</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>ID of the UNIX account in the system.</td></tr> <tr><td><span class="notranslate"><code>username</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>The name of the UNIX account in the system.</td></tr> <tr><td><span class="notranslate"><code>owner</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The name of the account owner in the control panel. The owner can be an administrator (in this case he should be included in the <span class="notranslate"><code>admins()</code></span> output) or a reseller (in this case he should be included in the <span class="notranslate"><code>resellers()</code></span> output).</td></tr> <tr><td><span class="notranslate"><code>locale_code</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The control panel locale selected by a user.</td></tr> <tr><td><span class="notranslate"><code>email</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>Email of the account user. If there is no email, it should return null.</td></tr> <tr><td><span class="notranslate"><code>domain</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The main domain of a user.</td></tr> <tr><td><span class="notranslate"><code>package</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>Information about the package to which a user belongs to. If the user doesn’t belong to any package, it should return null.</td></tr> <tr><td><span class="notranslate"><code>package.name</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>The name of the package to which a user belongs to.</td></tr> <tr><td><span class="notranslate"><code>package.owner</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The owner of the package to which a user belongs to (reseller or administrator).</td></tr></tbody></table> <h4 id="how-to-provide-information-about-domains"><a href="#how-to-provide-information-about-domains" aria-hidden="true" class="header-anchor">#</a> How to provide information about domains</h4> <p>Specify <span class="notranslate"><code>domains</code></span> option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_sctipts]</span>
<span class="token constant">domains</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-domains-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;subdomain.example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/subdomain/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p><span class="notranslate"><code>web_server_config_path</code></span> should point to a path that is added as <span class="notranslate"><code>IncludeOptional</code></span> in this domain's virtual host e.g., <span class="notranslate"><code>/path/to/example.com/specific/config/to/include</code></span> path should be added for the <span class="notranslate"><code>example.com</code></span> domain.</p> <h4 id="how-to-provide-information-about-the-control-panel"><a href="#how-to-provide-information-about-the-control-panel" aria-hidden="true" class="header-anchor">#</a> How to provide information about the control panel</h4> <p>Specify <span class="notranslate"><code>panel_info</code></span> option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">panel_info</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-panel-info-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SomeCoolWebPanel&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;user_login_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://{domain}:1111/&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h4 id="how-to-install-imunify360"><a href="#how-to-install-imunify360" aria-hidden="true" class="header-anchor">#</a> How to install Imunify360</h4> <h4 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h4> <ul><li><a href="https://modsecurity.org/" target="_blank" rel="noopener noreferrer">ModSecurity 2.9.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://httpd.apache.org/docs/2.4/mod/mod_remoteip.html" target="_blank" rel="noopener noreferrer">Apache Module mod_remoteip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Now everything is ready to install Imunify360.</p> <p>The installation instructions are the same as for
cPanel/Plesk/DirectAdmin version, and can be found in the
<a href="/installation/">documentation</a>.</p> <h4 id="how-to-configure-modsecurity-integration"><a href="#how-to-configure-modsecurity-integration" aria-hidden="true" class="header-anchor">#</a> How to configure ModSecurity integration</h4> <p>Configure <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#Configuration_Directives" target="_blank" rel="noopener noreferrer">ModSecurity configuration
directives<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
(so that it can block):</p> <div class="notranslate"><div class="language-apacheconf extra-class"><pre class="language-apacheconf"><code>SecAuditEngine = <span class="token string">&quot;RelevantOnly&quot;</span>
SecConnEngine = <span class="token string">&quot;Off&quot;</span>
SecRuleEngine = <span class="token string">&quot;On&quot;</span>
</code></pre></div></div> <p>Update your your web server config: add <span class="notranslate"><code>IncludeOptional</code></span> that points to the <span class="notranslate"><code>/etc/sysconfig/imunify360/generic/modsec.conf</code></span> file. Create the file
if it doesn't exist, otherwise, the web server might not start until
Imunify360 is installed (which creates the file).</p> <p>Set in <span class="notranslate"><code>integration.conf</code></span>:</p> <ul><li><span class="notranslate"><code>[web_server].server_type</code></span>​ – <span class="notranslate"><code>apache</code></span>/<span class="notranslate"><code>litespeed</code></span></li> <li><span class="notranslate"><code>[web_server].graceful_restart_script​</code></span> – a script that restarts the
web server to be called after any changes in web server config or ModSecurity rules.</li> <li><span class="notranslate"><code>[web_server].modsec_audit_log</code></span>​ – path to ModSecurity audit log file</li> <li><span class="notranslate"><code>[web_server].modsec_audit_logdir​</code></span> – path to ModSecurity audit log dir</li></ul> <p>Example:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[web_server]</span>
<span class="token constant">server_type</span> <span class="token attr-value"><span class="token punctuation">=</span> apache</span>
<span class="token constant">graceful_restart_script</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/a/script/that/restarts/web-server/properly</span>
<span class="token constant">modsec_audit_log</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/httpd/modsec_audit.log</span>
<span class="token constant">modsec_audit_logdir</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/modsec_audit</span>
</code></pre></div></div> <h4 id="how-to-configure-modsecurity-domain-level-integration"><a href="#how-to-configure-modsecurity-domain-level-integration" aria-hidden="true" class="header-anchor">#</a> How to configure ModSecurity domain level integration</h4> <p>To enable domain-specific ModSecurity configuration, specify
<span class="notranslate"><code>modsec_domain_config_script</code></span> in the <span class="notranslate"><code>integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[web_server]</span>
<span class="token constant">modsec_domain_config_script</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/inject/domain/specific/config/script.sh</span>

</code></pre></div></div> <p>It should point to an executable file that accepts as an input a list
of domain-specific web server settings and injects them into the
server config. The standard input (stdin) is given in the
<a href="http://jsonlines.org/" target="_blank" rel="noopener noreferrer">JSON Lines<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> format similar to:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example.com&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token string">&quot;modsec config text&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;another&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;another.example.com&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span>
</code></pre></div></div> <p>Each line contains config for a single domain e.g., it may contain
rule tags excluded for the domain.</p> <p>The script should also restart the web server to apply the
configuration. This should be done so that the script could implement
the check that web server comes up after config change, and reset
configuration if it doesn't.</p> <p>If configuration change failed, the script should return <code>1</code>, and in the
standard error stream (stderr) it should return the reason for
failure. On success, the script should return <code>0</code>.</p> <p>In a single run of the script, we might update a single domain/user, as
well as multiple users (all users) on the system.</p> <h4 id="how-to-configure-malware-scanner-integration"><a href="#how-to-configure-malware-scanner-integration" aria-hidden="true" class="header-anchor">#</a> How to configure malware scanner integration</h4> <p>To scan files uploaded via FTP, configure
<a href="https://www.pureftpd.org/project/pure-ftpd/" target="_blank" rel="noopener noreferrer">PureFTPd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Write in the <span class="notranslate"><code>pure-ftp.conf</code></span>:</p> <div class="notranslate"><pre><code>CallUploadScript             yes
</code></pre></div> <p>To scan files for changes (to detect malware) using inotify, configure
which directories to watch and which to ignore in the
<span class="notranslate"><code>integration.conf</code></span> file:</p> <ul><li>configure <span class="notranslate"><code>[malware].basedir</code></span> – a root directory to watch (recursively)</li> <li>configure <span class="notranslate"><code>[malware].pattern_to_watch</code></span> – only directories that match this
(<a href="https://docs.python.org/3/howto/regex.html#regex-howto" target="_blank" rel="noopener noreferrer">Python<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)
regex in the <span class="notranslate"><code>basedir</code></span> are actually going to be watched</li></ul> <p>Examples for already supported panels:</p> <ul><li>cPanel</li></ul> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token constant">basedir</span> <span class="token attr-value"><span class="token punctuation">=</span> /home</span>
<span class="token constant">pattern_to_watch</span> <span class="token attr-value"><span class="token punctuation">=</span> ^/home/.+?/(public_html|public_ftp|private_html)(/.*)?$</span>
</code></pre></div></div> <ul><li>DirectAdmin</li></ul> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token constant">basedir</span> <span class="token attr-value"><span class="token punctuation">=</span> /home</span>
<span class="token constant">pattern_to_watch</span> <span class="token attr-value"><span class="token punctuation">=</span> ^/home/(.+?|.+?/domains/.+?)/(public_html|public_ftp|private_html)(/.*)?$</span>
</code></pre></div></div> <ul><li>Plesk</li></ul> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token constant">basedir</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/www/vhosts/</span>
<span class="token constant">pattern_to_watch</span> <span class="token attr-value"><span class="token punctuation">=</span> ^/var/www/vhosts/.+?(?&lt;!/.skel|/chroot|/default|/system)(/.+?(?&lt;!/logs|/bin|/chroot|/other-from-VHOST_IGNORE)(/.*)?)?$</span>
</code></pre></div></div> <h4 id="how-to-open-imunify360-ui-once-imunify360-is-installed"><a href="#how-to-open-imunify360-ui-once-imunify360-is-installed" aria-hidden="true" class="header-anchor">#</a> How  to open Imunify360 UI once Imunify360 is installed</h4> <p>The web-based UI is available via the domain configured in <span class="notranslate"><code>ui_path</code></span>.</p> <p>For example, if
<span class="notranslate"><code>/var/www/vhosts/imunify360/imunify360.hosting.example.com/html/im360</code></span>
is the document root folder for the <span class="notranslate"><code>imunify360.hosting.example.com</code></span>
domain, then you could open ImunifyAV with the following URL:</p> <ul><li><span class="notranslate"><code>https://imunify360.hosting.example.com/</code></span> (when you have TLS
certificate configured for the domain) or</li> <li><span class="notranslate"><code>http://imunify360.hosting.example.com/</code></span></li></ul> <h4 id="extended-integration-conf-example-for-reference"><a href="#extended-integration-conf-example-for-reference" aria-hidden="true" class="header-anchor">#</a> Extended <span class="notranslate"><code>integration.conf</code></span> example for reference</h4> <p><span class="notranslate"><code>integration.conf</code></span> is a config in which all integration points should
be defined. It contains two kinds of fields:</p> <ul><li>A simple variable, for example, <span class="notranslate"><code>[web_server].server_type</code></span></li> <li>A path to a script that will return the data for Imunify360, for example,
<span class="notranslate"><code>[integration_scripts].domains</code></span>.</li></ul> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">panel_info</span> <span class="token attr-value"><span class="token punctuation">=</span> /opt/cpvendor/bin/panel_info</span>
<span class="token constant">users</span> <span class="token attr-value"><span class="token punctuation">=</span> /opt/cpvendor/bin/users</span>
<span class="token constant">domains</span> <span class="token attr-value"><span class="token punctuation">=</span> /opt/cpvendor/bin/vendor_integration_script domains</span>
<span class="token constant">admins</span> <span class="token attr-value"><span class="token punctuation">=</span> /opt/cpvendor/bin/vendor_integration_script admins</span>

<span class="token selector">[paths]</span>
<span class="token constant">ui_path</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/www/vhosts/im360/im360.example-hosting.com/html</span>

<span class="token selector">[web_server]</span>
<span class="token constant">server_type</span> <span class="token attr-value"><span class="token punctuation">=</span> apache</span>
<span class="token constant">graceful_restart_script</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/a/script/that/restarts/web-server/properly</span>
<span class="token constant">modsec_audit_log</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/httpd/modsec_audit.log</span>
<span class="token constant">modsec_audit_logdir</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/modsec_audit</span>

<span class="token selector">[malware]</span>
<span class="token constant">basedir</span> <span class="token attr-value"><span class="token punctuation">=</span> /home</span>
<span class="token constant">pattern_to_watch</span> <span class="token attr-value"><span class="token punctuation">=</span> ^/home/.+?/(public_html|public_ftp|private_html)(/.*)?$</span>
</code></pre></div></div> <p>Unless otherwise stated, the expected output/error handling for the
integrations scripts follows
<a href="https://docs.cloudlinux.com/control_panel_integration/#expected-structure-of-replies" target="_blank" rel="noopener noreferrer">https://docs.cloudlinux.com/control_panel_integration/#expected-structure-of-replies<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
interface.</p> <h4 id="further-steps"><a href="#further-steps" aria-hidden="true" class="header-anchor">#</a> Further steps</h4> <p>Detailed instructions on how to use Imunify360 can be found in the <a href="https://docs.imunify360.com/" target="_blank" rel="noopener noreferrer">Imunify360 documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>If you have any questions or experience any issues regarding the
product, submit a ticket to our technical support team. For feature
requests, just drop us an email to <a href="mailto:feedback@imunify360.com">feedback@imunify360.com</a>.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/stand_alone/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-5366e0dd><a href="/stand_alone/#app" class="nav-arrow top back-to-top__link" data-v-5366e0dd></a></div> </div> <div class="footer" data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.com" data-v-20b89de8><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-20b89de8></a></div> <div class="footer-company-title" data-v-20b89de8>2020. CloudLinux Inc</div> <div data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-20b89de8>How to</a></div><div data-v-20b89de8><a href="https://imunify360.com/getting-started" target="_blank" data-v-20b89de8>Getting started</a></div><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-20b89de8>Contact support</a></div><div data-v-20b89de8><a href="https://www.imunify360.com/blog" target="_blank" data-v-20b89de8>Blog</a></div></div> <div class="social" data-v-20b89de8><span class="footer-social-text" data-v-20b89de8>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-20b89de8><img src="/fb.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-20b89de8><img src="/tw.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-20b89de8><img src="/in.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-20b89de8><img src="/ytube.png" class="footer-social-logo" data-v-20b89de8></a></div></div> <!----></div></div>
    <script src="/assets/js/app.f76f4ac2.js" defer></script><script src="/assets/js/40.f1056a0e.js" defer></script>
  </body>
</html>
